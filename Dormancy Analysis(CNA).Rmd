---
title: "Dormancy Analysis (CNA)"
output: rmarkdown::github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### Defining Data Sets

Chloe's Dormancy Data
```{r}
dormant <- read.csv("Dormant_Data.csv")
```

cna Genes from https://www.cbioportal.org/study/summary?id=msk_met_2021
```{r}
cna <- read.csv("CNA.csv")
```

Changing the column name for gene to "Gene" in Chloe's dormancy data and innerjoining the two sets by the Gene column
```{r}
colnames(dormant)[4] <- "Gene"
data <- dplyr::inner_join(dormant, cna, by = "Gene")

```

### Quick numbers regarding genes the two sets share

Number of genes in Chloe's data
```{r}
length(dormant$Gene)
```

Number of genes in cbioportal data
```{r}
length(cna$Gene)
```

Number of Genes shared between the two

```{r}
length(data$Gene)
```

data will now have genes from the innerjoined set that have data from at least 4 studies in Chloe's data
```{r}
data <- data[data$cell_line_counts >= 4, ]
```

## Upregulated Genes
Upregulated genes will be defined as genes with at least 4 cell line counts and 1 or less downregulated count.
```{r}
upreg <- data[data$downreg_counts <= 1, ]
```

The amount of upregulated genes fitting our description above
```{r}
length(upreg[, 'Gene'])
```

The upregulated genes
```{r}
upreg$Gene
```

Frequencies of upregulated genes from cbioportal data
```{r}
rbind(upreg$Gene, upreg$Freq)

```
BCL2L1 and MAPK3 have the highest frequencies of CNA, so I will explore those further

### BCL2L1
```{r BCL2L1}
BCL2L1 <- upreg[upreg$Gene == "BCL2L1" & upreg$Freq == "1.50%", ]
```
Type of CNA
```{r}
BCL2L1$CNA
```

Mean of BCL2L1 cell line counts
```{r}
mean(as.numeric(BCL2L1[which(!is.na(BCL2L1[5:18])) + 4]))
```

Median of BCL2L1 cell line counts
```{r, error = TRUE}
median(as.numeric(BCL2L1[which(!is.na(BCL2L1[5:18])) + 4]))
```

### MAPK3
```{r MAPK3}
MAPK3 <- upreg[upreg$Gene == "MAPK3" & upreg$Freq == "0.30%", ]
```
Type of CNA
```{r}
MAPK3$CNA
```

Mean of MAPK3 cell line counts
```{r}
mean(as.numeric(MAPK3[which(!is.na(MAPK3[5:18])) + 4]))
```

Median of MAPK3 cell line counts
```{r}
median(as.numeric(MAPK3[which(!is.na(MAPK3[5:18])) + 4]))
```


## Downregulated Genes
Downregulated genes will be defined as genes with at least 4 cell line counts and 1 or less upregulated count.
```{r}
downreg <- data[data$upreg_counts <= 1, ]
```

Amount of downregulated genes fitting our description above
```{r}
length(downreg[, 'Gene'])
```

The downregulated genes
```{r}
downreg$Gene
```


Frequencies of downregulated genes

```{r}

rbind(downreg$Gene, downreg$Freq)

```
RAD21, ELOC, RB1, and CDK4 have the highest CNA so I will examine those closer.

### RAD21

```{r RAD21}
RAD21 <- downreg[downreg$Gene == "RAD21" & downreg$Freq == "2.30%", ]
```

Type of CNA
```{r}
RAD21$CNA
```

Mean of RAD21 cell line counts
```{r}
mean(as.numeric(RAD21[which(!is.na(RAD21[5:18])) + 4]))
```

Median of RAD21 cell line counts
```{r}
median(as.numeric(RAD21[which(!is.na(RAD21[5:18])) + 4]))
```

### ELOC

```{r ELOC}
ELOC <- downreg[downreg$Gene == "ELOC" & downreg$Freq == "1.40%", ]
```

Type of CNA 
```{r}
ELOC$CNA
```

Mean of ELOC cell line counts
```{r}
mean(as.numeric(ELOC[which(!is.na(ELOC[5:18])) + 4]))
```

Median of ELOC cell line counts
```{r}
median(as.numeric(ELOC[which(!is.na(ELOC[5:18])) + 4]))
```

### RB1

```{r RB1}
RB1 <- downreg[downreg$Gene == "RB1" & downreg$Freq == "1.80%", ]
```

Type of CNA
```{r}
RB1$CNA
```

Mean of RB1 cell line counts
```{r}
mean(as.numeric(RB1[which(!is.na(RB1[5:18])) + 4]))
```

Median of RB1 cell line counts
```{r}
median(as.numeric(RB1[which(!is.na(RB1[5:18])) + 4]))
```

### CDK4

```{r CDK4}
CDK4 <- downreg[downreg$Gene == "CDK4" & downreg$Freq == "2.10%", ]
```

Type of CNA
```{r}
CDK4$CNA
```

Mean of CDK4 cell line counts
```{r}
mean(as.numeric(CDK4[which(!is.na(CDK4[5:18])) + 4]))
```

Median of CDK4 cell line counts
```{r}
median(as.numeric(CDK4[which(!is.na(CDK4[5:18])) + 4]))
```

### Primary with metastasis vs without 

Defining data sets from https://www.cbioportal.org/study/summary?id=msk_met_2021. prim_met has all of the mutated genes data from samples prom primary tumors with metastasis, while prim_no_met has the mutated genes data from primary tumors with no metastasis
```{r}

prim_met <- read.csv("prim_met.csv")
prim_no_met <- read.csv("prim_no_met.csv")

```

### BCL2L1

Frequency of BCL2L1 in primary with metastasis
```{r}
prim_met[prim_met$Gene == "BCL2L1", "Freq"]
```

Frequency of BCL2L1 in primary without metastasis
```{r}
prim_no_met[prim_no_met$Gene == "BCL2L1", "Freq"]

```

### ELOC

Frequency of ELOC in primary with metastasis
```{r}
prim_met[prim_met$Gene == "ELOC", "Freq"]
```

Frequency of ELOC in primary without metastasis
```{r}
prim_no_met[prim_no_met$Gene == "ELOC", "Freq"]

```

### RB1

Frequency of RB1 in primary with metastasis
```{r}
prim_met[prim_met$Gene == "RB1", "Freq"]
```

Frequency of RB1 in primary without metastasis
```{r}
prim_no_met[prim_no_met$Gene == "RB1", "Freq"]

```


### CDK4

Frequency of CDK4 in primary with metastasis
```{r}
prim_met[prim_met$Gene == "CDK4", "Freq"]
```

Frequency of CDK4 in primary without metastasis
```{r}
prim_no_met[prim_no_met$Gene == "CDK4", "Freq"]

```
